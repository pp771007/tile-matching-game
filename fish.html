<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixi.js Aquarium</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        #aquarium {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>

<body>
    <div id="aquarium"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.4/pixi.min.js"></script>
    <script>
        // Create PIXI application
        const app = new PIXI.Application({
            width: 300,
            height: 200,
            backgroundColor: 0x0077be,
        });

        // Add the canvas to the DOM
        document.getElementById('aquarium').appendChild(app.view);

        // Load fish texture
        PIXI.Assets.load('images/fish.png').then((texture) => {
            // Create 1-3 fish
            const fishCount = Math.floor(Math.random() * 3) + 1;
            for (let i = 0; i < fishCount; i++) {
                createFish(app.stage, texture);
            }
        });

        // Create bubbles
        setInterval(() => createBubble(app.stage), 2000);

        // Start the animation
        app.ticker.add(() => {
            app.stage.children.forEach((child) => {
                if (child.isFish) {
                    moveFish(child, app.screen);
                } else if (child.isBubble) {
                    moveBubble(child, app.screen);
                }
            });
        });

        function createFish(stage, texture) {
            const fish = new PIXI.Sprite(texture);
            fish.anchor.set(0.5);
            fish.x = Math.random() * 300;
            fish.y = Math.random() * 200;
            fish.scale.set(0.2);
            fish.isFish = true;
            fish.direction = Math.random() * Math.PI * 2;
            fish.speed = 1 + Math.random();
            stage.addChild(fish);
        }

        function moveFish(fish, bounds) {
            fish.x += Math.cos(fish.direction) * fish.speed;
            fish.y += Math.sin(fish.direction) * fish.speed;

            if (fish.x < 0 || fish.x > bounds.width || fish.y < 0 || fish.y > bounds.height) {
                fish.direction = Math.random() * Math.PI * 2;
            }

            fish.scale.x = Math.cos(fish.direction) > 0 ? -0.2 : 0.2;
        }

        function createBubble(stage) {
            const bubble = new PIXI.Graphics();
            bubble.beginFill(0xffffff, 0.5);
            bubble.drawCircle(0, 0, 2 + Math.random() * 3);
            bubble.endFill();
            bubble.x = Math.random() * 300;
            bubble.y = 200;
            bubble.isBubble = true;
            bubble.speed = 0.5 + Math.random();
            stage.addChild(bubble);
        }

        function moveBubble(bubble, bounds) {
            bubble.y -= bubble.speed;
            if (bubble.y < 0) {
                bubble.destroy();
            }
        }
    </script>
</body>

</html>
