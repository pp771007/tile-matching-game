<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create.js Aquarium</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
        }

        #aquarium {
            border: 1px solid #000;
        }
    </style>
    <script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
</head>

<body>
    <canvas id="aquarium" width="300" height="200"></canvas>

    <script>
        let stage, fishes = [], bubbles = [];
        const AQUARIUM_WIDTH = 300;
        const AQUARIUM_HEIGHT = 200;

        function init() {
            stage = new createjs.Stage("aquarium");
            createjs.Ticker.timingMode = createjs.Ticker.RAF;
            createjs.Ticker.addEventListener("tick", tick);

            // 创建背景
            let background = new createjs.Shape();
            background.graphics.beginFill("#0077be").drawRect(0, 0, AQUARIUM_WIDTH, AQUARIUM_HEIGHT);
            stage.addChild(background);

            // 加载鱼的图片
            let fishImage = new Image();
            fishImage.src = "images/海洋生物/小丑魚.png";
            fishImage.onload = function () {
                // 创建1-2条鱼
                for (let i = 0; i < Math.floor(Math.random() * 2) + 1; i++) {
                    createFish(fishImage);
                }
            }

            // 每2秒创建一个气泡
            setInterval(createBubble, 2000);
        }

        function createFish(image) {
            let fish = new createjs.Bitmap(image);
            fish.scaleX = fish.scaleY = 0.2; // 调整鱼的大小
            fish.regX = image.width / 2;
            fish.regY = image.height / 2;
            fish.x = Math.random() * AQUARIUM_WIDTH;
            fish.y = Math.random() * AQUARIUM_HEIGHT;
            fish.direction = Math.random() * Math.PI * 2;
            fish.speed = 1 + Math.random();

            fishes.push(fish);
            stage.addChild(fish);
        }

        function createBubble() {
            let bubble = new createjs.Shape();
            bubble.graphics.beginFill("rgba(255,255,255,0.5)").drawCircle(0, 0, 2 + Math.random() * 3);
            bubble.x = Math.random() * AQUARIUM_WIDTH;
            bubble.y = AQUARIUM_HEIGHT;
            bubble.speed = 0.5 + Math.random();

            bubbles.push(bubble);
            stage.addChild(bubble);
        }

        function tick(event) {
            // 移动鱼
            fishes.forEach(fish => {
                fish.x += Math.cos(fish.direction) * fish.speed;
                fish.y += Math.sin(fish.direction) * fish.speed;

                if (fish.x < 0 || fish.x > AQUARIUM_WIDTH || fish.y < 0 || fish.y > AQUARIUM_HEIGHT) {
                    fish.direction = Math.random() * Math.PI * 2;
                }

                fish.scaleX = Math.cos(fish.direction) > 0 ? -0.2 : 0.2; // 翻转鱼的方向
            });

            // 移动气泡
            bubbles.forEach((bubble, index) => {
                bubble.y -= bubble.speed;
                if (bubble.y < 0) {
                    stage.removeChild(bubble);
                    bubbles.splice(index, 1);
                }
            });

            stage.update(event);
        }

        init();
    </script>
</body>

</html>
